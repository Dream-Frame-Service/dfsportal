var It=Object.defineProperty;var Ut=(P,u,d)=>u in P?It(P,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):P[u]=d;var z=(P,u,d)=>Ut(P,typeof u!="symbol"?u+"":u,d);import{j as t}from"./ui-D8yO-OxE.js";import{r as l,u as Tt,i as Mt}from"./vendor-XhsmhKu1.js";import{c as Lt,E as Z,C as tt,f as rt,k as J,B as y,R as K,b as Pt,d as ft,A as $t,g as At,u as at,X as Ot,s as q,i as Ht,T as Wt,n as Vt,o as pt,p as I,q as Gt,r as U,h as lt,e as Qt}from"./index-DRBMqcxT.js";import{I as T}from"./input-O-h5M17i.js";import{C as ut,U as mt,N as D,T as Xt}from"./textarea-B-Q9Uetu.js";import{L as g}from"./label-ByQLJlol.js";import{S as W,a as V,b as G,c as Q,d as X}from"./select-D0pEHiDr.js";import{D as yt,f as _t,a as jt,b as vt,c as Ft,d as Yt}from"./dialog--irBdw-G.js";import{u as Jt}from"./AuthContext-Bo8HSNc2.js";import{S as bt}from"./save-C9ClsOGX.js";import{S as ht}from"./separator-CZaaJG51.js";import{D as Kt}from"./download-CAI3Hb-E.js";import{D as Zt}from"./dollar-sign-OBnb8nXG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=Lt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);class tr extends l.Component{constructor(d){super(d);z(this,"errorLogger");z(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null},this.errorLogger=Z.getInstance()}static getDerivedStateFromError(d){return{hasError:!0,error:d,errorInfo:null}}componentDidCatch(d,i){const c=this.props.severity||"medium",f=this.props.componentName||"Unknown Component";this.errorLogger.log(d,c,`ComponentErrorBoundary - ${f}`,i,{component:f,url:window.location.href,timestamp:new Date().toISOString()}),this.setState({error:d,errorInfo:i}),this.props.onError&&this.props.onError(d,i)}render(){if(this.state.hasError&&this.state.error){if(this.props.fallback){const d=this.props.fallback;return t.jsx(d,{error:this.state.error,resetError:this.handleReset,errorInfo:this.state.errorInfo,componentName:this.props.componentName,"data-id":"fnb0gt7fa","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx"})}return t.jsx(tt,{className:"bg-red-50 border-red-200 border-2",style:{minHeight:this.props.minHeight||"auto"},"data-id":"u4id1borq","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:t.jsx(rt,{className:"p-4","data-id":"9isa1zn6t","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:t.jsx("div",{className:"flex items-center justify-center text-center","data-id":"wq5r1pf7d","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:t.jsxs("div",{className:"space-y-3","data-id":"jfsd4j1bd","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx("div",{className:"flex items-center justify-center text-red-600","data-id":"gaz6exm82","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:t.jsx(J,{size:24,"data-id":"gkfcithgp","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx"})}),t.jsxs("div",{"data-id":"j3z8qmr6a","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx("h3",{className:"font-semibold text-red-800 text-sm","data-id":"d6hziynwg","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:"Component Error"}),t.jsxs("p",{className:"text-red-600 text-xs mt-1","data-id":"hjdifgto7","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[this.props.componentName||"This component"," encountered an error"]})]}),t.jsxs(y,{onClick:this.handleReset,size:"sm",variant:"outline",className:"border-red-300 text-red-700 hover:bg-red-100","data-id":"2u4hbiecv","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx(K,{size:14,className:"mr-1","data-id":"utll9ux2h","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx"}),"Retry"]}),this.props.showErrorDetails&&t.jsxs("details",{className:"mt-2 text-xs text-red-600","data-id":"o2mnuse1n","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx("summary",{className:"cursor-pointer hover:text-red-800","data-id":"12fgo0dp3","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:"Error Details"}),t.jsxs("div",{className:"mt-1 text-left bg-red-100 p-2 rounded font-mono text-xs","data-id":"jhpnqra4w","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsxs("div",{"data-id":"xn1spat0z","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"3sst9i0hb","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:"Error:"})," ",this.state.error.message]}),this.state.error.stack&&t.jsxs("div",{className:"mt-1","data-id":"moidzeyq0","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"wb5v3pbq3","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:"Stack:"}),t.jsx("pre",{className:"whitespace-pre-wrap text-xs","data-id":"njt5g1n1r","data-path":"src/components/ErrorBoundary/ComponentErrorBoundary.tsx",children:this.state.error.stack.split(`
`).slice(0,3).join(`
`)})]})]})]})]})})})})}return this.props.children}}class rr extends l.Component{constructor(d){super(d);z(this,"errorLogger");z(this,"attemptFormDataRecovery",()=>{try{const d=document.querySelectorAll("input, select, textarea"),i={};return d.forEach(c=>{if(c.name||c.id){const f=c.name||c.id;c.type==="checkbox"||c.type==="radio"?i[f]=c.checked:i[f]=c.value}}),i}catch(d){return console.warn("Failed to recover form data:",d),{}}});z(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});z(this,"handleFormReset",()=>{this.props.onFormReset&&this.props.onFormReset(),this.handleReset()});z(this,"handleDataSave",()=>{this.props.onDataSave&&this.props.onDataSave()});this.state={hasError:!1,error:null,errorInfo:null},this.errorLogger=Z.getInstance()}static getDerivedStateFromError(d){return{hasError:!0,error:d,errorInfo:null}}componentDidCatch(d,i){const c=this.props.formName||"Unknown Form";this.errorLogger.log(d,"high",`FormErrorBoundary - ${c}`,i,{form:c,url:window.location.href,timestamp:new Date().toISOString(),formData:this.attemptFormDataRecovery()}),this.setState({error:d,errorInfo:i})}render(){if(this.state.hasError&&this.state.error){if(this.props.fallback){const d=this.props.fallback;return t.jsx(d,{error:this.state.error,resetError:this.handleReset,errorInfo:this.state.errorInfo,formName:this.props.formName,onFormReset:this.handleFormReset,onDataSave:this.handleDataSave,"data-id":"azrzj1hk7","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"})}return t.jsxs(tt,{className:"bg-red-50 border-red-200 border-2","data-id":"o9oy5mqpb","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(Pt,{className:"pb-3","data-id":"e7j4mj6bu","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:t.jsxs(ft,{className:"flex items-center gap-2 text-red-800 text-lg","data-id":"qnunxliw0","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(J,{size:20,"data-id":"krsr4xyy3","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"}),"Form Error Detected"]})}),t.jsxs(rt,{className:"space-y-4","data-id":"p0jb9ivwp","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsxs($t,{className:"border-red-300 bg-red-100","data-id":"x107yl2ul","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(J,{className:"h-4 w-4","data-id":"qy5uoxuev","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"}),t.jsxs(At,{className:"text-red-800","data-id":"i2sluoe32","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:["An error occurred while processing the"," ",this.props.formName?`${this.props.formName} form`:"form",".",this.props.showDataRecovery&&t.jsx("span",{className:"block mt-1 text-sm","data-id":"nasi086i0","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Your form data may have been preserved and can be recovered."})]})]}),t.jsx("div",{className:"space-y-2","data-id":"vhehq0iiw","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:t.jsxs("p",{className:"text-sm text-red-700","data-id":"lsco323xy","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"78v9et2bi","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Error:"})," ",this.state.error.message]})}),t.jsxs("div",{className:"flex flex-wrap gap-2","data-id":"rgxwg3h8n","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsxs(y,{onClick:this.handleReset,variant:"default",size:"sm",className:"flex items-center gap-2","data-id":"tqvzrxrnt","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(K,{size:16,"data-id":"ilqq3ie0x","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"}),"Retry Form"]}),this.props.onFormReset&&t.jsxs(y,{onClick:this.handleFormReset,variant:"outline",size:"sm",className:"flex items-center gap-2 border-red-300 text-red-700 hover:bg-red-100","data-id":"hfvv8cghy","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(K,{size:16,"data-id":"ct81b6oa2","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"}),"Reset Form"]}),this.props.showDataRecovery&&this.props.onDataSave&&t.jsxs(y,{onClick:this.handleDataSave,variant:"secondary",size:"sm",className:"flex items-center gap-2","data-id":"ah2mnwc7h","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx(bt,{size:16,"data-id":"ue6vkf90d","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx"}),"Save Draft"]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-4","data-id":"ieg2buvrl","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("h4",{className:"font-semibold text-yellow-800 text-sm mb-2","data-id":"w0xe7mhsq","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Recovery Tips:"}),t.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1","data-id":"gwnuiolpx","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("li",{"data-id":"t98pt9lk8","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"• Try refreshing the page and filling out the form again"}),t.jsx("li",{"data-id":"o592m2kox","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"• Check that all required fields are properly filled"}),t.jsx("li",{"data-id":"bdp73qm7c","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"• Ensure your internet connection is stable"}),this.props.showDataRecovery&&t.jsx("li",{"data-id":"dfoej8nvp","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:'• Use "Save Draft" to preserve your current data'})]})]}),t.jsxs("details",{className:"mt-3","data-id":"r05gzfi8t","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("summary",{className:"cursor-pointer text-xs text-red-600 hover:text-red-800","data-id":"27qigrobz","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Technical Details"}),t.jsxs("div",{className:"mt-2 bg-red-100 p-2 rounded text-xs font-mono text-red-800","data-id":"j8weabzf5","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsxs("div",{"data-id":"yqi6sbfp3","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"d4xmj0lyg","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Component:"})," ",this.props.formName||"Form"]}),t.jsxs("div",{"data-id":"nekl0qjsr","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"k8r3j2sdf","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Error Type:"})," ",this.state.error.name]}),t.jsxs("div",{"data-id":"1y41ihf9w","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:[t.jsx("strong",{"data-id":"zybkn7amd","data-path":"src/components/ErrorBoundary/FormErrorBoundary.tsx",children:"Time:"})," ",new Date().toLocaleString()]})]})]})]})]})}return this.props.children}}const ar=(P={})=>{const{toast:u}=at(),d=Z.getInstance(),{component:i="Unknown Component",showToast:c=!0,logError:f=!0,severity:w="medium"}=P,k=l.useCallback((F,j,E)=>{const h=typeof F=="string"?new Error(F):F;f&&d.log(h,w,i,void 0,E),c&&u({variant:"destructive",title:"Error",description:j||h.message||"An unexpected error occurred"})},[i,c,f,w,u,d]),M=l.useCallback(async(F,j,E)=>{try{return await F()}catch(h){return k(h instanceof Error?h:new Error(String(h)),j,E),null}},[k]),L=l.useCallback(async(F,j,E)=>{try{const h=await F();if(h.error)throw new Error(h.error);return h.data||null}catch(h){return k(h instanceof Error?h:new Error(String(h)),j,E),null}},[k]);return{handleError:k,handleAsync:M,handleApiCall:L}},gt=({onScan:P,triggerText:u="Scan Barcode",disabled:d=!1})=>{const i=l.useRef(null),c=l.useRef(null),[f,w]=l.useState(!1),[k,M]=l.useState(null),[L,F]=l.useState(!1),{toast:j}=at(),E=async()=>{try{const v=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});i.current&&(i.current.srcObject=v,M(v),F(!0))}catch(v){console.error("Error accessing camera:",v),j({variant:"destructive",title:"Camera Error",description:"Unable to access camera. Please check permissions."})}},h=()=>{k&&(k.getTracks().forEach(v=>v.stop()),M(null),F(!1))},$=()=>{if(i.current&&c.current){const v=i.current,A=c.current,a=A.getContext("2d");if(a){A.width=v.videoWidth,A.height=v.videoHeight,a.drawImage(v,0,0);const _=Math.random().toString(36).substr(2,12).toUpperCase();P(_),w(!1),h(),j({title:"Barcode Scanned",description:`Detected barcode: ${_}`})}}};return l.useEffect(()=>(f?E():h(),()=>{h()}),[f]),t.jsx(tr,{componentName:"BarcodeScanner",severity:"medium",minHeight:"200px","data-id":"3pibg6ms7","data-path":"src/components/BarcodeScanner.tsx",children:t.jsxs(yt,{open:f,onOpenChange:w,"data-id":"39q67l96m","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(_t,{asChild:!0,"data-id":"avk5syt1n","data-path":"src/components/BarcodeScanner.tsx",children:t.jsxs(y,{type:"button",variant:"outline",size:"sm",disabled:d,"data-id":"y6ol20tpr","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(ut,{className:"w-4 h-4 mr-2","data-id":"st0einn3s","data-path":"src/components/BarcodeScanner.tsx"}),u]})}),t.jsxs(jt,{className:"sm:max-w-md","data-id":"3crr5yoy5","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(vt,{"data-id":"pcs34g8fb","data-path":"src/components/BarcodeScanner.tsx",children:t.jsx(Ft,{"data-id":"vr2r4ah79","data-path":"src/components/BarcodeScanner.tsx",children:"Scan Barcode"})}),t.jsxs("div",{className:"flex flex-col items-center space-y-4","data-id":"m2yxl59b5","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsxs("div",{className:"relative w-full max-w-sm aspect-video bg-black rounded-lg overflow-hidden","data-id":"jv41adqnn","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover","data-id":"umo9yuczd","data-path":"src/components/BarcodeScanner.tsx"}),t.jsx("canvas",{ref:c,className:"hidden","data-id":"1zqrqnpg4","data-path":"src/components/BarcodeScanner.tsx"}),!L&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white","data-id":"4n61y3quc","data-path":"src/components/BarcodeScanner.tsx",children:t.jsxs("div",{className:"text-center","data-id":"0yw8fuk6s","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(ut,{className:"w-12 h-12 mx-auto mb-2","data-id":"blxgzp25x","data-path":"src/components/BarcodeScanner.tsx"}),t.jsx("p",{"data-id":"ebyr1flvg","data-path":"src/components/BarcodeScanner.tsx",children:"Initializing camera..."})]})})]}),t.jsxs("div",{className:"flex space-x-2","data-id":"ga2zy4vyi","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(y,{onClick:$,disabled:!L,"data-id":"gdiold53r","data-path":"src/components/BarcodeScanner.tsx",children:"Capture"}),t.jsxs(y,{variant:"outline",onClick:()=>w(!1),"data-id":"6hay25d0q","data-path":"src/components/BarcodeScanner.tsx",children:[t.jsx(Ot,{className:"w-4 h-4 mr-2","data-id":"62fns4deb","data-path":"src/components/BarcodeScanner.tsx"}),"Cancel"]})]}),t.jsx("p",{className:"text-sm text-muted-foreground text-center","data-id":"ypqys8ed6","data-path":"src/components/BarcodeScanner.tsx",children:"Position the barcode within the camera view and click Capture"})]})]})]})})},yr=()=>{const P=Tt(),{id:u}=Mt(),{toast:d}=at(),{userProfile:i}=Jt();ar({component:"ProductForm",severity:"high"});const c=!!u,[f,w]=l.useState(!1),[k,M]=l.useState([]),[L,F]=l.useState([]),[j,E]=l.useState([]),[h,$]=l.useState(!1),[v,A]=l.useState(!1),[a,_]=l.useState({product_name:"",weight:0,weight_unit:"lb",department:"Convenience Store",merchant_id:"",last_updated_date:new Date().toISOString().split("T")[0],last_shopping_date:"",case_price:0,unit_per_case:1,unit_price:0,retail_price:0,profit_margin:0,category:"",supplier:"",quantity_in_stock:0,minimum_stock:0,description:"",bar_code_case:"",bar_code_unit:"",serial_number:0,overdue:!1}),[R,wt]=l.useState(null),Et=[{value:"lb",label:"Pounds (lb)"},{value:"oz",label:"Ounces (oz)"},{value:"ton",label:"Tons"},{value:"fl_oz",label:"Fluid Ounces (fl oz)"},{value:"gal",label:"Gallons (gal)"},{value:"qt",label:"Quarts (qt)"},{value:"pt",label:"Pints (pt)"},{value:"cup",label:"Cups"},{value:"tbsp",label:"Tablespoons (tbsp)"},{value:"tsp",label:"Teaspoons (tsp)"}],Bt=["Convenience Store","Fuel & Oil","Automotive","Food & Beverages","Tobacco Products","Lottery & Gaming","Health & Personal Care","Electronics & Accessories","Cleaning Supplies","Office Supplies","Snacks & Candy","Hot Foods & Coffee","Cold Beverages","Energy Drinks","Beer & Wine","Ice & Frozen","Phone Cards & Prepaid","Car Accessories","Gift Cards","Pharmacy & Medicine"];l.useEffect(()=>{kt(),Nt(),c?st():et()},[u]),l.useEffect(()=>{if(a.case_price>0&&a.unit_per_case>0){const r=a.case_price/a.unit_per_case;_(s=>({...s,unit_price:Math.round(r*100)/100}))}},[a.case_price,a.unit_per_case]),l.useEffect(()=>{if(a.unit_price>0){const r=Y(a.unit_price);a.retail_price===0&&_(s=>({...s,retail_price:r}))}else a.unit_price===0&&_(r=>({...r,retail_price:0}))},[a.unit_price]),l.useEffect(()=>{if(a.unit_price>0&&a.retail_price>0){const r=(a.retail_price-a.unit_price)/a.retail_price*100;_(s=>({...s,profit_margin:Math.round(r*100)/100}))}else _(r=>({...r,profit_margin:0}))},[a.unit_price,a.retail_price]);const kt=async()=>{try{const{data:r,error:s}=await q.from("vendors").select("*").eq("is_active",!0).order("vendor_name",{ascending:!0}).limit(100);if(s)throw s;M(r||[])}catch(r){console.error("Error fetching vendors:",r)}},Nt=async()=>{try{const{data:r,error:s}=await q.from("product_categories").select("*").eq("is_active",!0).order("category_name",{ascending:!0}).limit(100);if(s)throw s;F(r||[])}catch(r){console.error("Error fetching categories:",r)}},et=async()=>{var r;try{const{data:s,error:o}=await q.from("products").select("serial_number").order("serial_number",{ascending:!1}).limit(1);if(o)throw o;const e=((r=s==null?void 0:s[0])==null?void 0:r.serial_number)||0;_(p=>({...p,serial_number:e+1}))}catch(s){console.error("Error generating serial number:",s),_(o=>({...o,serial_number:1}))}},st=async()=>{var r;if(u){w(!0);try{const{data:s,error:o}=await q.from("products").select("*").eq("id",u).limit(1).single();if(o)throw o;if(s){const e=s,p={product_name:e.product_name||"",weight:e.weight||0,weight_unit:e.weight_unit||"lb",department:e.department||"Convenience Store",merchant_id:((r=e.merchant_id)==null?void 0:r.toString())||"",last_updated_date:e.last_updated_date?e.last_updated_date.split("T")[0]:"",last_shopping_date:e.last_shopping_date?e.last_shopping_date.split("T")[0]:"",case_price:e.case_price||0,unit_per_case:e.unit_per_case||1,unit_price:e.unit_price||0,retail_price:e.retail_price||0,profit_margin:0,category:e.category||"",supplier:e.supplier||"",quantity_in_stock:e.quantity_in_stock||0,minimum_stock:e.minimum_stock||0,description:e.description||"",bar_code_case:e.bar_code_case||"",bar_code_unit:e.bar_code_unit||"",serial_number:e.serial_number||0,overdue:e.overdue||!1};_(p),wt(p)}}catch(s){console.error("Error fetching product:",s),d({variant:"destructive",title:"Error",description:"Failed to load product data."})}finally{w(!1)}}},Y=r=>{if(r===0)return 0;let s=0;r<4?s=65:r>=4&&r<6?s=55:r>=6&&r<8?s=45:r>=8&&r<10?s=35:s=25;const o=r*(1+s/100),e=[.25,.49,.75,.99],p=Math.floor(o),m=o-p;let S=.99,N=Math.abs(m-.99);return e.forEach(n=>{const B=Math.abs(m-n);B<N&&(N=B,S=n)}),p+S},x=(r,s)=>{_(o=>({...o,[r]:s}))},dt=(r,s)=>{_(o=>({...o,[r]:s})),d({title:"Barcode Scanned",description:`Barcode ${s} added to ${r.replace("_"," ")}`})},Ct=r=>{var e;const s=(e=r.target.files)==null?void 0:e[0];if(!s)return;const o=new FileReader;o.onload=p=>{var m;try{const N=((m=p.target)==null?void 0:m.result).split(`
`).filter(C=>C.trim()),n=N[0].split(",").map(C=>C.trim().toLowerCase()),B=N.slice(1).map((C,er)=>{const Dt=C.split(","),b={};return n.forEach((ct,Rt)=>{var nt;let H=((nt=Dt[Rt])==null?void 0:nt.trim())||"";const it={"product name":"product_name",product_name:"product_name",weight:"weight","weight unit":"weight_unit",weight_unit:"weight_unit",department:"department",merchant:"merchant_id",merchant_id:"merchant_id","last shopping date":"last_shopping_date",last_shopping_date:"last_shopping_date","case price":"case_price",case_price:"case_price","unit per case":"unit_per_case",unit_per_case:"unit_per_case","unit price":"unit_price",unit_price:"unit_price","retail price":"retail_price",retail_price:"retail_price",category:"category",supplier:"supplier",description:"description"}[ct]||ct;["weight","case_price","unit_per_case","unit_price","retail_price","merchant_id"].includes(it)&&(H=H&&parseFloat(H)||0),b[it]=H}),b.case_price>0&&b.unit_per_case>0&&!b.unit_price&&(b.unit_price=Math.round(b.case_price/b.unit_per_case*100)/100),b.unit_price>0&&!b.retail_price&&(b.retail_price=Y(b.unit_price)),b});E(B),$(!0)}catch{d({variant:"destructive",title:"Error",description:"Failed to parse CSV file. Please check the format."})}},o.readAsText(s)},St=async()=>{var r,s,o;if(!i){d({variant:"destructive",title:"Error",description:"User profile not found."});return}A(!0);try{let e=0,p=0;const m=[],N=((s=(r=(await q.from("products").select("serial_number").order("serial_number",{ascending:!1}).limit(1)).data)==null?void 0:r[0])==null?void 0:s.serial_number)||0;for(const n of j)try{if(!((o=n.product_name)!=null&&o.trim())){m.push(`Row ${e+p+1}: Product name is required`),p++;continue}const B={serial_number:N+e+1,product_name:n.product_name.trim(),last_updated_date:new Date().toISOString(),overdue:!1,weight:n.weight||0,weight_unit:n.weight_unit||"lb",department:n.department||"Convenience Store",case_price:n.case_price||0,unit_per_case:n.unit_per_case||1,unit_price:n.unit_price||0,retail_price:n.retail_price||0,category:n.category||"",supplier:n.supplier||"",description:n.description||"",quantity_in_stock:0,minimum_stock:0,bar_code_case:"",bar_code_unit:"",created_by:i.user_id};n.merchant_id&&(B.merchant_id=parseInt(n.merchant_id)),n.last_shopping_date&&(B.last_shopping_date=new Date(n.last_shopping_date).toISOString());const{error:C}=await q.from("products").insert(B);C?(m.push(`${n.product_name}: ${C}`),p++):e++}catch(B){const C=B instanceof Error?B.message:"Unknown error";m.push(`${n.product_name||"Unknown"}: ${C}`),p++}e>0?d({title:"Import Complete",description:`Successfully imported ${e} products. ${p>0?`${p} errors occurred.`:""}`}):d({variant:"destructive",title:"Import Failed",description:`No products were imported. ${p} errors occurred.`}),m.length>0&&console.error("Import errors:",m),e>0&&($(!1),E([]),P("/products"))}catch(e){console.error("Bulk import error:",e),d({variant:"destructive",title:"Import Failed",description:e instanceof Error?e.message:"Failed to import product data."})}finally{A(!1)}},ot=async(r,s,o,e,p)=>{try{const{error:m}=await q.from("product_field_changes").insert({product_id:r,field_name:s,old_value:(o==null?void 0:o.toString())||"",new_value:(e==null?void 0:e.toString())||"",change_date:new Date().toISOString(),changed_by:p});m&&console.error("Error logging field change:",m)}catch(m){console.error("Error logging field change:",m)}},qt=async r=>{if(r.preventDefault(),!a.product_name.trim()){d({variant:"destructive",title:"Validation Error",description:"Product name is required."});return}if(!i){d({variant:"destructive",title:"Error",description:"User profile not found."});return}w(!0);try{const s={...a,last_updated_date:new Date().toISOString(),last_shopping_date:a.last_shopping_date?new Date(a.last_shopping_date).toISOString():null,merchant_id:a.merchant_id?parseInt(a.merchant_id):null,created_by:i.user_id},{error:o}=c?await q.from("products").update(s).eq("id",parseInt(u)):await q.from("products").insert(s);if(o)throw o;if(c&&R&&i){const e=["last_shopping_date","case_price","unit_per_case","unit_price","retail_price"];for(const S of e){const N=R[S],n=a[S];N!==n&&await ot(parseInt(u),S,N,n,i.user_id)}const p=R.unit_price>0&&R.retail_price>0?(R.retail_price-R.unit_price)/R.retail_price*100:0,m=a.profit_margin;Math.abs(p-m)>.01&&await ot(parseInt(u),"profit_margin",p.toFixed(2),m.toFixed(2),i.user_id)}d({title:"Success",description:`Product ${c?"updated":"created"} successfully.`}),P("/products")}catch(s){console.error("Error saving product:",s),d({variant:"destructive",title:"Error",description:`Failed to ${c?"update":"create"} product.`})}finally{w(!1)}},O=Y(a.unit_price),zt=()=>{const r=["Product Name,Weight,Weight Unit,Department,Merchant,Case Price,Unit Per Case,Unit Price,Retail Price,Category,Supplier,Description","Example Product,12,oz,Food & Beverages,,24.00,24,1.00,1.99,Soft Drinks,Example Supplier,Example description"].join(`
`),s=new Blob([r],{type:"text/csv"}),o=window.URL.createObjectURL(s),e=document.createElement("a");e.style.display="none",e.href=o,e.download="product_import_template.csv",document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(o),document.body.removeChild(e)};return t.jsxs("div",{className:"container mx-auto p-6 space-y-6","data-id":"bx12wklbd","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex items-center justify-between","data-id":"q5k5t85tc","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex items-center space-x-4","data-id":"wlu98sixy","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs(y,{variant:"outline",size:"sm",onClick:()=>P("/products"),"data-id":"bdw35t5fy","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(Ht,{className:"w-4 h-4 mr-2","data-id":"rtvwkpjqu","data-path":"src/pages/Products/ProductForm.tsx"}),"Back to Products"]}),t.jsxs("div",{"data-id":"q5m983vey","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h1",{className:"text-2xl font-bold","data-id":"41gy26pq3","data-path":"src/pages/Products/ProductForm.tsx",children:c?"Edit Product":"Add New Product"}),t.jsx("p",{className:"text-muted-foreground","data-id":"h07pjygjz","data-path":"src/pages/Products/ProductForm.tsx",children:c?"Update product information":"Add a new product to your inventory"})]})]}),t.jsxs(yt,{open:h,onOpenChange:$,"data-id":"hi7kexvnf","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(_t,{asChild:!0,"data-id":"93g6amn9o","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsxs(y,{variant:"outline","data-id":"uy4lxewlc","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(mt,{className:"w-4 h-4 mr-2","data-id":"h92678uku","data-path":"src/pages/Products/ProductForm.tsx"}),"Bulk Upload"]})}),t.jsxs(jt,{className:"max-w-6xl max-h-[80vh] overflow-auto","data-id":"0nz2kj64x","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs(vt,{"data-id":"rmb9repv9","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(Ft,{"data-id":"s0xq7459l","data-path":"src/pages/Products/ProductForm.tsx",children:"Bulk Product Upload"}),t.jsx(Yt,{"data-id":"hlbqg641c","data-path":"src/pages/Products/ProductForm.tsx",children:'Upload a CSV file with product data. Click "Download Template" for the correct format.'})]}),j.length===0?t.jsxs("div",{className:"space-y-4","data-id":"otrmnjarm","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex justify-between items-center","data-id":"jnbayeohh","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h3",{className:"text-lg font-medium","data-id":"iflfxutqr","data-path":"src/pages/Products/ProductForm.tsx",children:"Upload CSV File"}),t.jsxs(y,{variant:"outline",onClick:zt,"data-id":"7citiads7","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(Kt,{className:"w-4 h-4 mr-2","data-id":"6gsm7c3h7","data-path":"src/pages/Products/ProductForm.tsx"}),"Download Template"]})]}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center","data-id":"l6duwtega","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(mt,{className:"w-12 h-12 mx-auto text-gray-400 mb-4","data-id":"bvz7kpd58","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsxs("div",{className:"space-y-2","data-id":"xqwub2p94","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h3",{className:"text-lg font-medium","data-id":"kjou9apny","data-path":"src/pages/Products/ProductForm.tsx",children:"Upload CSV File"}),t.jsx("p",{className:"text-sm text-gray-500","data-id":"3xwvpr12u","data-path":"src/pages/Products/ProductForm.tsx",children:"Select a CSV file containing product data"}),t.jsx(T,{type:"file",accept:".csv",onChange:Ct,className:"max-w-xs mx-auto","data-id":"r8qynfi9q","data-path":"src/pages/Products/ProductForm.tsx"})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4","data-id":"3dwp5fzxb","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2","data-id":"u2zoncman","data-path":"src/pages/Products/ProductForm.tsx",children:"Required Columns:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1","data-id":"rhkwpjqrw","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("li",{"data-id":"guya2pqun","data-path":"src/pages/Products/ProductForm.tsx",children:"• Product Name (required)"}),t.jsx("li",{"data-id":"tgq6dgo04","data-path":"src/pages/Products/ProductForm.tsx",children:"• Weight, Weight Unit, Department, Merchant"}),t.jsx("li",{"data-id":"jvpyf8maa","data-path":"src/pages/Products/ProductForm.tsx",children:"• Case Price, Unit Per Case, Unit Price, Retail Price"}),t.jsx("li",{"data-id":"44pem9vcv","data-path":"src/pages/Products/ProductForm.tsx",children:"• Category, Supplier, Description"})]})]})]}):t.jsxs("div",{className:"space-y-4","data-id":"13jnbnr6s","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex items-center justify-between","data-id":"vl7z3re82","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("h3",{className:"text-lg font-medium","data-id":"x7eodbrud","data-path":"src/pages/Products/ProductForm.tsx",children:["Preview Import Data (",j.length," products)"]}),t.jsxs("div",{className:"space-x-2","data-id":"spwy9543p","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(y,{variant:"outline",onClick:()=>{E([]),$(!1)},"data-id":"nf798ix7z","data-path":"src/pages/Products/ProductForm.tsx",children:"Cancel"}),t.jsx(y,{onClick:St,disabled:v,"data-id":"s0l90qs0w","data-path":"src/pages/Products/ProductForm.tsx",children:v?"Importing...":"Import Products"})]})]}),t.jsx("div",{className:"border rounded-lg max-h-96 overflow-auto","data-id":"8knn1mgms","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsxs(Wt,{"data-id":"p9k1dq6d0","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(Vt,{"data-id":"1d31nj8tz","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsxs(pt,{"data-id":"7ay0v18xb","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(I,{"data-id":"3aba6dsmt","data-path":"src/pages/Products/ProductForm.tsx",children:"Product Name"}),t.jsx(I,{"data-id":"h7safkm9m","data-path":"src/pages/Products/ProductForm.tsx",children:"Weight"}),t.jsx(I,{"data-id":"fnhhv5m54","data-path":"src/pages/Products/ProductForm.tsx",children:"Department"}),t.jsx(I,{"data-id":"eoxwo0so8","data-path":"src/pages/Products/ProductForm.tsx",children:"Case Price"}),t.jsx(I,{"data-id":"lietay58u","data-path":"src/pages/Products/ProductForm.tsx",children:"Unit Price"}),t.jsx(I,{"data-id":"vob1mrzrz","data-path":"src/pages/Products/ProductForm.tsx",children:"Retail Price"}),t.jsx(I,{"data-id":"9qxs82bs8","data-path":"src/pages/Products/ProductForm.tsx",children:"Profit %"})]})}),t.jsx(Gt,{"data-id":"nyr9xf477","data-path":"src/pages/Products/ProductForm.tsx",children:j.map((r,s)=>{var e,p,m;const o=r.unit_price>0&&r.retail_price>0?((r.retail_price-r.unit_price)/r.retail_price*100).toFixed(1):"0";return t.jsxs(pt,{"data-id":"0w8qpnjpw","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(U,{className:"font-medium","data-id":"ztfzojfdy","data-path":"src/pages/Products/ProductForm.tsx",children:r.product_name}),t.jsxs(U,{"data-id":"qxwlle97c","data-path":"src/pages/Products/ProductForm.tsx",children:[r.weight," ",r.weight_unit]}),t.jsx(U,{"data-id":"nawb7vr9m","data-path":"src/pages/Products/ProductForm.tsx",children:r.department}),t.jsxs(U,{"data-id":"6ackpc71i","data-path":"src/pages/Products/ProductForm.tsx",children:["$",((e=r.case_price)==null?void 0:e.toFixed(2))||"0.00"]}),t.jsxs(U,{"data-id":"ag0ksahtm","data-path":"src/pages/Products/ProductForm.tsx",children:["$",((p=r.unit_price)==null?void 0:p.toFixed(2))||"0.00"]}),t.jsxs(U,{"data-id":"4yr04zme5","data-path":"src/pages/Products/ProductForm.tsx",children:["$",((m=r.retail_price)==null?void 0:m.toFixed(2))||"0.00"]}),t.jsx(U,{"data-id":"iecxknd33","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsxs(lt,{variant:parseFloat(o)>20?"default":"secondary","data-id":"kbs73ub5d","data-path":"src/pages/Products/ProductForm.tsx",children:[o,"%"]})})]},s)})})]})})]})]})]})]}),t.jsxs(tt,{"data-id":"ybi5y9x0t","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs(Pt,{"data-id":"c0sro9agp","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(ft,{"data-id":"yblpzeajq","data-path":"src/pages/Products/ProductForm.tsx",children:c?"Edit Product":"New Product"}),t.jsx(Qt,{"data-id":"4snm2u3bc","data-path":"src/pages/Products/ProductForm.tsx",children:c?"Update the product information below":"Enter the product details below"})]}),t.jsx(rt,{"data-id":"9gdcuh4ed","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsx(rr,{formName:"Product Form",showDataRecovery:!0,onFormReset:()=>{c?st():(_({product_name:"",weight:0,weight_unit:"lb",department:"Convenience Store",merchant_id:"",last_updated_date:new Date().toISOString().split("T")[0],last_shopping_date:"",case_price:0,unit_per_case:1,unit_price:0,retail_price:0,profit_margin:0,category:"",supplier:"",quantity_in_stock:0,minimum_stock:0,description:"",bar_code_case:"",bar_code_unit:"",serial_number:0,overdue:!1}),et())},"data-id":"cktkquzxl","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsxs("form",{onSubmit:qt,className:"space-y-6","data-id":"b47e9aqag","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6","data-id":"xjmwfhyiz","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"kglmcicue","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"product_name","data-id":"phoq35hdt","data-path":"src/pages/Products/ProductForm.tsx",children:"Product Name *"}),t.jsx(T,{id:"product_name",placeholder:"Enter product name",value:a.product_name,onChange:r=>x("product_name",r.target.value),required:!0,"data-id":"rjrlm6qa7","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"5wnmbfxgz","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"category","data-id":"4rvslpa8b","data-path":"src/pages/Products/ProductForm.tsx",children:"Category"}),t.jsxs(W,{value:a.category,onValueChange:r=>x("category",r),"data-id":"cj8kg9x7v","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(V,{"data-id":"h53ofq07e","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsx(G,{placeholder:"Select category","data-id":"lt19useuz","data-path":"src/pages/Products/ProductForm.tsx"})}),t.jsx(Q,{"data-id":"tu1fli4s7","data-path":"src/pages/Products/ProductForm.tsx",children:L.map(r=>t.jsx(X,{value:r.category_name,"data-id":"dxg4exzsk","data-path":"src/pages/Products/ProductForm.tsx",children:r.category_name},r.id))})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6","data-id":"kcclizqrd","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"rbfly9jkc","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"weight","data-id":"5kewfxhrq","data-path":"src/pages/Products/ProductForm.tsx",children:"Weight"}),t.jsx(D,{id:"weight",step:.01,min:0,value:a.weight,onChange:r=>x("weight",r),"data-id":"ntm2991pu","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"dpy100zkt","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"weight_unit","data-id":"lmhazo1o2","data-path":"src/pages/Products/ProductForm.tsx",children:"Weight Unit (USA Measurements)"}),t.jsxs(W,{value:a.weight_unit,onValueChange:r=>x("weight_unit",r),"data-id":"ykhzxj6ot","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(V,{"data-id":"ibo0fui0o","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsx(G,{placeholder:"Select unit","data-id":"wikid8ydq","data-path":"src/pages/Products/ProductForm.tsx"})}),t.jsx(Q,{"data-id":"o46bsqe2q","data-path":"src/pages/Products/ProductForm.tsx",children:Et.map(r=>t.jsx(X,{value:r.value,"data-id":"vr3gmqpg9","data-path":"src/pages/Products/ProductForm.tsx",children:r.label},r.value))})]}),t.jsxs("p",{className:"text-xs text-muted-foreground","data-id":"ilqscfzlv","data-path":"src/pages/Products/ProductForm.tsx",children:["Combined: ",a.weight," ",a.weight_unit]})]}),t.jsxs("div",{className:"space-y-2","data-id":"qsxt1su8b","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"department","data-id":"ui00cry10","data-path":"src/pages/Products/ProductForm.tsx",children:"Department"}),t.jsxs(W,{value:a.department,onValueChange:r=>x("department",r),"data-id":"9e5cpkg0a","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(V,{"data-id":"o17mjjiz5","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsx(G,{placeholder:"Select department","data-id":"onct4n5nl","data-path":"src/pages/Products/ProductForm.tsx"})}),t.jsx(Q,{"data-id":"5w12yqkd7","data-path":"src/pages/Products/ProductForm.tsx",children:Bt.map(r=>t.jsx(X,{value:r,"data-id":"f42auxyjl","data-path":"src/pages/Products/ProductForm.tsx",children:r},r))})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6","data-id":"8ev602vbv","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"2a4vpkma2","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"merchant_id","data-id":"lyuaqm4jk","data-path":"src/pages/Products/ProductForm.tsx",children:"Merchant"}),t.jsxs(W,{value:a.merchant_id,onValueChange:r=>x("merchant_id",r),"data-id":"07ewjpxem","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(V,{"data-id":"r6bhwqo6v","data-path":"src/pages/Products/ProductForm.tsx",children:t.jsx(G,{placeholder:"Select merchant","data-id":"gcgdwhskz","data-path":"src/pages/Products/ProductForm.tsx"})}),t.jsx(Q,{"data-id":"stxcuz9bv","data-path":"src/pages/Products/ProductForm.tsx",children:k.map(r=>t.jsx(X,{value:r.id.toString(),"data-id":"8t00h2uci","data-path":"src/pages/Products/ProductForm.tsx",children:r.vendor_name},r.id))})]})]}),t.jsxs("div",{className:"space-y-2","data-id":"7xotykfm4","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"last_updated_date","data-id":"d4wo4tj5g","data-path":"src/pages/Products/ProductForm.tsx",children:"Last Updated Date"}),t.jsx(T,{id:"last_updated_date",type:"date",value:a.last_updated_date,onChange:r=>x("last_updated_date",r.target.value),"data-id":"afigj8q8r","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"joc9bnqgp","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"last_shopping_date","data-id":"nfkbcc485","data-path":"src/pages/Products/ProductForm.tsx",children:"Last Shopping Date"}),t.jsx(T,{id:"last_shopping_date",type:"date",value:a.last_shopping_date,onChange:r=>x("last_shopping_date",r.target.value),"data-id":"4brvqnedm","data-path":"src/pages/Products/ProductForm.tsx"})]})]}),t.jsx(ht,{"data-id":"9o0gwbwwq","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsxs("div",{className:"space-y-4","data-id":"wbwknuhfy","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h3",{className:"text-lg font-medium","data-id":"yu7bdekm3","data-path":"src/pages/Products/ProductForm.tsx",children:"Pricing Information"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6","data-id":"iwqed2cq2","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"h13mzseq5","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"case_price","data-id":"3yq7lv3rt","data-path":"src/pages/Products/ProductForm.tsx",children:"Case Price ($)"}),t.jsx(D,{id:"case_price",step:.01,min:0,value:a.case_price,onChange:r=>x("case_price",r),"data-id":"8lif39lep","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"8ilbz7re9","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"unit_per_case","data-id":"lu93lxaue","data-path":"src/pages/Products/ProductForm.tsx",children:"Unit Per Case"}),t.jsx(D,{id:"unit_per_case",min:1,value:a.unit_per_case,onChange:r=>x("unit_per_case",r),"data-id":"xpreug7g1","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"sqleu9w7o","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"unit_price","data-id":"bw3hnk8lw","data-path":"src/pages/Products/ProductForm.tsx",children:"Unit Price ($)"}),t.jsx(D,{id:"unit_price",step:.01,min:0,value:a.unit_price,onChange:r=>x("unit_price",r),"data-id":"bhjy2741g","data-path":"src/pages/Products/ProductForm.tsx"}),a.case_price>0&&a.unit_per_case>0&&t.jsxs("p",{className:"text-xs text-green-600 flex items-center","data-id":"mig3drq7h","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(xt,{className:"w-3 h-3 mr-1","data-id":"9wwkfvxsf","data-path":"src/pages/Products/ProductForm.tsx"}),"Auto-calculated from case price"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6","data-id":"7szavq7wt","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"s44v0bd4c","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"retail_price","data-id":"sw3slkr61","data-path":"src/pages/Products/ProductForm.tsx",children:"Retail Price ($)"}),t.jsx(D,{id:"retail_price",step:.01,min:0,value:a.retail_price,onChange:r=>x("retail_price",r),"data-id":"nhp6pvirq","data-path":"src/pages/Products/ProductForm.tsx"}),a.unit_price>0&&Math.abs(a.retail_price-O)<.01&&t.jsxs("p",{className:"text-xs text-green-600 flex items-center","data-id":"c6694zlow","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(xt,{className:"w-3 h-3 mr-1","data-id":"7j2ylnx8a","data-path":"src/pages/Products/ProductForm.tsx"}),"Auto-calculated from unit price"]}),a.unit_price>0&&Math.abs(a.retail_price-O)>=.01&&t.jsxs("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg","data-id":"7ggtw6coy","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex items-center justify-between","data-id":"ggamngcao","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"flex items-center space-x-2","data-id":"1l6080zer","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(Zt,{className:"w-4 h-4 text-red-600","data-id":"r1rmqer56","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsxs("span",{className:"text-sm font-medium text-red-800","data-id":"hs4p8lfhn","data-path":"src/pages/Products/ProductForm.tsx",children:["Suggested: $",O.toFixed(2)]})]}),t.jsx(y,{type:"button",size:"sm",variant:"outline",onClick:()=>x("retail_price",O),className:"text-xs h-6 px-2","data-id":"rhpckr8hc","data-path":"src/pages/Products/ProductForm.tsx",children:"Apply"})]}),t.jsxs("p",{className:"text-xs text-red-700 mt-1","data-id":"on56s08f2","data-path":"src/pages/Products/ProductForm.tsx",children:[a.unit_price<4?"+65%":a.unit_price<6?"+55%":a.unit_price<8?"+45%":a.unit_price<10?"+35%":"+25%"," markup, rounded to .25/.49/.75/.99"]})]})]}),t.jsxs("div",{className:"space-y-2","data-id":"orczwe7jq","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"profit_margin","data-id":"sq9xzux3z","data-path":"src/pages/Products/ProductForm.tsx",children:"Profit Margin (%)"}),t.jsxs("div",{className:"flex items-center space-x-2","data-id":"jf7rutm1u","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(D,{id:"profit_margin",step:.01,value:a.profit_margin,disabled:!0,className:"bg-muted","data-id":"uiwlfbodg","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsx(lt,{variant:a.profit_margin>20?"default":"secondary","data-id":"3fkohoku4","data-path":"src/pages/Products/ProductForm.tsx",children:a.profit_margin>20?"Good":"Low"})]}),t.jsx("p",{className:"text-xs text-muted-foreground","data-id":"p6l0gv7lg","data-path":"src/pages/Products/ProductForm.tsx",children:"Auto-calculated from unit and retail price"})]})]})]}),t.jsx(ht,{"data-id":"rqx6u6vw5","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsxs("div",{className:"space-y-4","data-id":"rpa5p141o","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx("h3",{className:"text-lg font-medium","data-id":"kkeqlckhp","data-path":"src/pages/Products/ProductForm.tsx",children:"Additional Information"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6","data-id":"t1uth5etf","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"br0f51o36","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"supplier","data-id":"nwezqijbs","data-path":"src/pages/Products/ProductForm.tsx",children:"Supplier"}),t.jsx(T,{id:"supplier",placeholder:"Enter supplier name",value:a.supplier,onChange:r=>x("supplier",r.target.value),"data-id":"txymx9tx5","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"space-y-2","data-id":"9x4r9yo2t","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{"data-id":"2f1u5b9f8","data-path":"src/pages/Products/ProductForm.tsx",children:"Stock Information"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2","data-id":"qa7poz02u","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(D,{placeholder:"Current Stock",value:a.quantity_in_stock,onChange:r=>x("quantity_in_stock",r),min:0,"data-id":"aizhy7ulb","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsx(D,{placeholder:"Min Stock",value:a.minimum_stock,onChange:r=>x("minimum_stock",r),min:0,"data-id":"dckcsjdop","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsx("p",{className:"text-xs text-muted-foreground","data-id":"hbdkhswsk","data-path":"src/pages/Products/ProductForm.tsx",children:"Current stock / Minimum stock level"})]})]}),t.jsxs("div",{className:"space-y-2","data-id":"i6cs0n1a2","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"description","data-id":"vr0yez4f7","data-path":"src/pages/Products/ProductForm.tsx",children:"Description"}),t.jsx(Xt,{id:"description",placeholder:"Enter product description",rows:4,value:a.description,onChange:r=>x("description",r.target.value),"data-id":"pi8xzw20m","data-path":"src/pages/Products/ProductForm.tsx"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6","data-id":"bcdeqdoq5","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsxs("div",{className:"space-y-2","data-id":"00ykzf331","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"bar_code_case","data-id":"sx2pox7kt","data-path":"src/pages/Products/ProductForm.tsx",children:"Barcode (Case)"}),t.jsxs("div",{className:"flex space-x-2","data-id":"6ri7xrix9","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(T,{id:"bar_code_case",placeholder:"Scan or enter case barcode",value:a.bar_code_case,onChange:r=>x("bar_code_case",r.target.value),"data-id":"bzbisylmd","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsx(gt,{onScanned:r=>dt("bar_code_case",r),"data-id":"98bp73w7a","data-path":"src/pages/Products/ProductForm.tsx"})]})]}),t.jsxs("div",{className:"space-y-2","data-id":"x7tmyo56s","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(g,{htmlFor:"bar_code_unit","data-id":"hdxeaxie5","data-path":"src/pages/Products/ProductForm.tsx",children:"Barcode (Unit)"}),t.jsxs("div",{className:"flex space-x-2","data-id":"s3j3g1f3f","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(T,{id:"bar_code_unit",placeholder:"Scan or enter unit barcode",value:a.bar_code_unit,onChange:r=>x("bar_code_unit",r.target.value),"data-id":"5irm9j9k9","data-path":"src/pages/Products/ProductForm.tsx"}),t.jsx(gt,{onScanned:r=>dt("bar_code_unit",r),"data-id":"eshdnhw4l","data-path":"src/pages/Products/ProductForm.tsx"})]})]})]})]}),t.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6","data-id":"2pgb4f3ov","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(y,{type:"button",variant:"outline",onClick:()=>P("/products"),"data-id":"t2fbqbrwk","data-path":"src/pages/Products/ProductForm.tsx",children:"Cancel"}),t.jsxs(y,{type:"submit",disabled:f,"data-id":"fp7m4hvvp","data-path":"src/pages/Products/ProductForm.tsx",children:[t.jsx(bt,{className:"w-4 h-4 mr-2","data-id":"e2dbj22gs","data-path":"src/pages/Products/ProductForm.tsx"}),f?"Saving...":c?"Update Product":"Create Product"]})]})]})})})]})]})};export{yr as default};
//# sourceMappingURL=ProductForm-DyKY4kp5.js.map
